<!-- Block: chat -->
<div class="chat" id="chat" data-controller="chat">
  <!-- Element: header -->
  <header class="chat__header">
    <h2 class="chat__title"><%= "RealEstateAI" %></h2>
    <p class="chat__subtitle">With <%= @assistant.name %></p>
  </header>

  <!-- Element: messages container -->
  <div class="chat__messages" id="chat-messages" aria-live="polite" role="log">
    <% @conversation.messages.each do |msg| %>
      <% modifier = msg.user? ? 'chat__message--me' : 'chat__message--other' %>

      <article class="chat__message <%= modifier %>" data-message-id="<%= msg.id %>">
        <div class="chat__meta">
          <span class="chat__author"><%= msg.user_name %></span>
          <time class="chat__time"><%= l(msg.created_at, format: :short) %></time>
        </div>

        <div class="chat__bubble">
          <p class="chat__text"><%= simple_format(h(msg.content)) %></p>
        </div>
      </article>
    <% end %>

    <!-- Typing indicator element (hidden by default) -->
    <div class="chat__typing" id="chat-typing" aria-hidden="true">
      <div class="chat__typing-dot"></div>
      <div class="chat__typing-dot"></div>
      <div class="chat__typing-dot"></div>
      <span class="chat__typing-label"><%= @assistant.name %> is typingâ€¦</span>
    </div>
  </div>

  <!-- Element: composer (input area) -->
  <footer class="chat__composer">
    <%= 
      render "form",
      conversation: @conversation,
      url: "/public/conversations",
      method: :post
    %>
  </footer>
</div>
